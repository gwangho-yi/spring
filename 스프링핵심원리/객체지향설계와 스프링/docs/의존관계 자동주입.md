## ë‹¤ì–‘í•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ë²•

ì˜ì¡´ê´€ê³„ ì£¼ì… 4ê°€ì§€ ë°©ë²•

- ìƒì„±ì ì£¼ì…
- ìˆ˜ì •ì ì£¼ì…( setter ì£¼ì…)
- í•„ë“œ ì£¼ì…
- ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

### ìƒì„±ì ì£¼ì…

- ì´ë¦„ ê·¸ëŒ€ë¡œ ìƒì„±ìë¥¼ í†µí•´ì„œ ì˜ì¡´ ê´€ê³„ë¥¼ ì£¼ì… ë°›ëŠ” ë°©ë²•
- ì§€ê¸ˆê¹Œì§€ í•™ìŠµí–ˆë˜ ë°©ë²•
- íŠ¹ì§•
  - ìƒì„±ì í˜¸ì¶œ ì‹œì ì— ë”± 1ë²ˆë§Œ í˜¸ì¶œë˜ëŠ” ê²ƒì´ ë³´ì¥ëœë‹¤.
  - **ë¶ˆë³€, í•„ìˆ˜** ì˜ì¡´ê´€ê³„ì— ì‚¬ìš©
  - ìƒì„±ìê°€ ë”± 1ê°œì¼ ë•ŒëŠ” `@Autowired` ë¥¼ **ìƒëµí•´ë„ ìë™ ì£¼ì…**ëœë‹¤.

```java
  	@Autowired   <- ìƒì„±ì í•˜ë‚˜ì¼ ë•ŒëŠ” ì‚¬ì‹¤ ìƒëµí•´ë„ ëœë‹¤.
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
```

### ìˆ˜ì •ì ì£¼ì…(setter ì£¼ì…)

- setterë¼ ë¶ˆë¦¬ëŠ” í•„ë“œì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ìˆ˜ì •ì ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì˜ì¡´ê´€ê³„ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•ì´ë‹¤.
- íŠ¹ì§•
  - **ì„ íƒ, ë³€ê²½** ê°€ëŠ¥ì„±ì´ ìˆëŠ” ì˜ì¡´ ê´€ê³„ì— ì‚¬ìš©
  - ìë°”ë¹ˆ í”„ë¡œí„°í”¼ ê·œì•½ì˜ ìˆ˜ì •ì ë©”ì„œë“œ ë°©ì‹ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
- `@Autowired` ëŠ” ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒ. ì£¼ì… ëŒ€ìƒì´ ì—†ì–´ë„ ë™ì‘í•˜ê²Œ í•˜ë ¤ë©´

  `@Autowired(required=false)` ë¡œ ì§€ì •í•œë‹¤.


```java
		@Autowired
		public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }
    
    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }
```

### í•„ë“œ ì£¼ì…

- í•„ë“œì— ì£¼ì…í•˜ëŠ” ë°©ì‹
- íŠ¹ì§•
  - ì½”ë“œê°€ ê°„ê²°í•˜ì§€ë§Œ ì™¸ë¶€ì—ì„œ ë³€ê²½ì´ ë¶ˆê°€ëŠ¥í•´ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸° í˜ë“¤ë‹¤
  - ì“°ì§€ë§ì

### ì¼ë°˜ ë©”ì„œë“œ ì£¼ì…

- ì¼ë°˜ ë©”ì„œë“œë¥¼ í†µí•´ì„œ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.
- íŠ¹ì§•
  - í•œë²ˆì— ì—¬ëŸ¬ í•„ë“œë¥¼ ì£¼ì… ë°›ì„ ìˆ˜ ìˆë‹¤.
  - ì¼ë°˜ì ìœ¼ë¡œ ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.


```java
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public init(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }
```

**ì˜ì¡´ê´€ê³„ ìë™ì£¼ì…ì€ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤í”„ë§ ë¹ˆì´ì–´ì•¼ ë™ì‘**í•œë‹¤. ìŠ¤í”„ë§ ë¹ˆì´ ì•„ë‹Œ Member ê°™ì€ í´ë˜ìŠ¤ì—ì„œ  @Autowiredë¥¼ ì‚¬ìš©í•´ë„ ë™ì‘ X

## ì˜µì…˜ ì²˜ë¦¬

ì£¼ì…í•  ìŠ¤í”„ë§ ë¹ˆì´ ì—†ì–´ë„ ë™ì‘í•´ì•¼ í•  ë•Œ ì‚¬ìš©.

`@Autowired`ë§Œ ì‚¬ìš©í•˜ë©´ reqired ì˜µì…˜ì˜ ê¸°ë³¸ ê°’ì´ trueë¡œ ë˜ì–´ ìˆì–´ì„œ ìë™ ì£¼ì… ëŒ€ìƒì´ ì—†ìœ¼ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

ìë™ ì£¼ì… ëŒ€ìƒì„ ì˜µì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- `@Autowired(required=false)` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ ìˆ˜ì •ì ë©”ì„œë“œ ìì²´ê°€ í˜¸ì¶œ ì•ˆ ë¨
- `@Nullable` : ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ nullì´ ì…ë ¥
- `Optional<>` ìë™ ì£¼ì…í•  ëŒ€ìƒì´ ì—†ìœ¼ë©´ Optional.emptyê°€ ì…ë ¥

```java
  static class TestBean {

        @Autowired(required = false)
        public void setNoBean1(Member noMember1) {
            System.out.println("noMember1 = " + noMember1);
        }

        @Autowired
        public void setNoBean2(@Nullable Member noMember2) {
            System.out.println("noMember2 = " + noMember2);
        }

        @Autowired
        public void setNoBean3(Optional<Member> noBean3) {
            System.out.println("noBean3 = " + noBean3);
        }
    }
```

## ìƒì„±ì ì£¼ì…ì„ ì„ íƒí•˜ë¼!

ìŠ¤í”„ë§ì„ í¬í•¨í•œ DI í”„ë ˆì„ì›Œí¬ ëŒ€ë¶€ë¶„ì´ ìƒì„±ì ì£¼ì…ì„ ê¶Œì¥í•˜ëŠ” ì´ìœ 

### ë¶ˆë³€

- ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…ì€ í•œë²ˆ ì¼ì–´ë‚˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì‹œì ê¹Œì§€ ì˜ì¡´ ê´€ê³„ë¥¼ ë³€ê²½í•  ì¼ì´ ì—†ë‹¤. ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ ê´€ê³„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì „ê¹Œì§€ ë³€í•˜ë©´ ì•ˆ ëœë‹¤.(ë¶ˆë³€í•´ì•¼í•œë‹¤)
- ìˆ˜ì •ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´, set ë©”ì„œë“œë¥¼ publicìœ¼ë¡œ ì—´ì–´ ë‘ì–´ì•¼ í•œë‹¤.
- ëˆ„êµ°ê°€ ì‹¤ìˆ˜ë¡œ ë³€ê²½í•  ìˆ˜ë„ ìˆê³ , ë³€ê²½í•˜ë©´ ì•ˆ ë˜ëŠ” ë©”ì„œë“œë¥¼ ì—´ì–´ë‘ëŠ” ê²ƒì€ ì¢‹ì€ ì„¤ê³„ ë°©ë²•ì´ ì•„ë‹ˆë‹¤.
- ìƒì„±ì ì£¼ì…ì€ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ë”± 1ë²ˆë§Œ í˜¸ì¶œ ë˜ë¯€ë¡œ ì´í›„ì— í˜¸ì¶œë˜ëŠ” ì¼ì´ ì—†ë‹¤. ë”°ë¼ì„œ ë¶ˆë³€í•˜ê²Œ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤.

### ëˆ„ë½

í”„ë ˆì„ì›Œí¬ ì—†ì´ ìˆœìˆ˜í•œ ìë°” ì½”ë“œë¥¼ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í•˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.

ìˆ˜ì •ì ì£¼ì… ì‚¬ìš© ì‹œ ë§ˆì£¼ í•  ìˆ˜ ìˆëŠ” ë¬¸ì œ

```java
@Component
public class OrderServiceImpl implements OrderService{

    private  MemberRepository memberRepository;
    private  DiscountPolicy discountPolicy;

    @Autowired
    public void setMemberRepository(MemberRepository memberRepository) {
        this.memberRepository = memberRepository;
    }

    @Autowired
    public void setDiscountPolicy(DiscountPolicy discountPolicy) {
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        // createOrderëŠ” í• ì¸ ì •ì±…ì„ ëª°ë¼ë„ ë˜ê¸° ë•Œë¬¸ì— ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì˜ ì§€í‚¨ ê²ƒì´ë‹¤.
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

```java
class OrderServiceImplTest {
	// createOrderë§Œ í…ŒìŠ¤íŠ¸ í•˜ê³  ì‹¶ì—ˆëŠ”ë° 
	// OrderServiceImplì˜ memberRepositoryê°€ null ì´ê¸° ë•Œë¬¸ì— ì»´íŒŒì¼ ì—ëŸ¬ë‚œë‹¤
    @Test
    void createOrder() {
        OrderServiceImpl orderService = new OrderServiceImpl();
        orderService.createOrder(1L, "itemA", 10000);
    }

}
```

ìˆ˜ì •

```java
@Component
public class OrderServiceImpl implements OrderService{

    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy;

    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
        this.discountPolicy = discountPolicy;
    }

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        Member member = memberRepository.findById(memberId);
        // createOrderëŠ” í• ì¸ ì •ì±…ì„ ëª°ë¼ë„ ë˜ê¸° ë•Œë¬¸ì— ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ì˜ ì§€í‚¨ ê²ƒì´ë‹¤.
        int discountPrice = discountPolicy.discount(member, itemPrice);
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

```java
class OrderServiceImplTest {

    @Test
    void createOrder() {

        MemoryMemberRepository memberRepository = new MemoryMemberRepository();
        memberRepository.save(new Member(1L, "name", Grade.VIP));

        OrderServiceImpl orderService = new OrderServiceImpl(memberRepository, new FixDiscountPolicy());
        Order order = orderService.createOrder(1L, "itemA", 10000);
        assertThat(order.getDiscountPrice()).isEqualTo(1000);

    }

}
```

### ìƒì„±ì ì£¼ì… ì“°ë©´ ì¢‹ì€ì 

- ìƒì„±ì ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í•„ë“œì— fianl í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. final í‚¤ì›Œë“œê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ ë°œìƒ ì‹œ ì»´íŒŒì¼ ì‹œì ì— ë§‰ì„ ìˆ˜ ìˆë‹¤
- ì˜¤ì§ ìƒì„±ì ì£¼ì… ë°©ì‹ë§Œ final í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    ```java
    private final MemberRepository memberRepository;
    private final DiscountPolicy discountPolicy; <- ì–˜ê°€ ìƒì„±ìì— í• ë‹¹ X ë¼ì„œ ì˜¤ë¥˜ë‚œë‹¤. 
    
    @Autowired
    public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
        this.memberRepository = memberRepository;
    }
    ```


### ì •ë¦¬

- ìƒì„±ì ì£¼ì…ì“°ì. ë‘ ë²ˆ ì“°ì.
- í…ŒìŠ¤íŠ¸í•  ë•Œ ìˆ˜ì •ì ì£¼ì…ë³´ë‹¤ ì˜¤ë¥˜ë¥¼ ì‰½ê²Œ ì°¾ì„ ìˆ˜ ìˆë‹¤.
- í•„ë“œì— final ì“¸  ìˆ˜ ìˆì–´ì„œ ì»´íŒŒì¼ ì‹œì ì— ì˜¤ë¥˜ ì¡ì„ ìˆ˜ ìˆë‹¤.

## ë¡¬ë³µê³¼ ìµœì‹  íŠ¸ë Œë“œ

`@RequiredArgsConstructor` ì˜ ì—­í• 

```java

// ì´ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.
@Autowired
public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
}

```

## ì¡°íšŒ ë¹ˆì´ 2ê°œ ì´ìƒ ì¼ ë•Œ

`@Autowired` ëŠ” íƒ€ì…(Type)ìœ¼ë¡œ ì¡°íšŒí•œë‹¤.

```java
@Autowired
private DiscountPolicy discountPolicy
```

íƒ€ì… ì¡°íšŒê¸° ë•Œë¬¸ì— ì‹¤ì œëŠ” ì•„ë˜ì™€ ë™ì¼í•˜ê²Œ ë™ì‘.

`ac.getBean(DiscountPolicy.class)`

ì„ íƒëœ ë¹ˆì´ í•˜ë‚˜ ì¼ ë•ŒëŠ” ë¬¸ì œ ì—†ì§€ë§Œ ë‘ê°œê°€ ìˆë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

```java
@Component
public class OrderServiceImpl implements OrderService {
		@Autowired
    private DiscountPolicy discountPolicy;
}

@Component
public class FixDiscountPolicy implements DiscountPolicy {
}

@Component
public class RateDiscountPolicy implements DiscountPolicy {
}
```

ì¡°íšŒ í•  ë¹ˆì´ 2ê°œ ì´ìƒì´ê³  í•˜ë‚˜ë§Œ ì •í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì—ëŸ¬ê°€ í„°ì§„ë‹¤.

ê·¸ëŸ¼ í•˜ìœ„ íƒ€ì…ì¸ FixDiscountPolicy ë‚˜  RateDiscountPolicy ë¡œ ì§€ì •í•˜ë©´ ë˜ëŠ”ê±° ì•„ë‹Œê°€??

í•˜ì§€ë§Œ ê·¸ë ‡ê²Œ ë˜ë©´ DIPë¥¼ ìœ„ë°°í•˜ê³  í• ì¸ì •ì±… ë°”ë€Œë©´ ë˜ ìˆ˜ì •í•´ì•¼í•˜ë‹ˆ ì½”ë“œ ìœ ì—°ì„±ë„ ë–¨ì–´ì§„ë‹¤.

ê·¸ë¦¬ê³  ì´ë¦„ë§Œ ë‹¤ë¥´ê³  ë™ì¼í•œ íƒ€ì…ì˜ ë¹ˆì´ 2ê°œê°€ ìˆìœ¼ë©´ í•´ê²°ì´ ì•ˆëœë‹¤.

## @Autowired í•„ë“œ ëª…, @Qualifier, @Primary

- @Autowired í•„ë“œ ëª… ë§¤ì¹­
- @Qualifier â†’ @Qualifierë¼ë¦¬ ë§¤ì¹­  â†’ ë¹ˆ ì´ë¦„ ë§¤ì¹­
- @Primary ì‚¬ìš©

### `@Autowired` í•„ë“œ ëª… ë§¤ì¹­

`@Autowired` ëŠ” ë§¤ì¹­ì„ ì‹œí‚¤ëŠ” ë‹¨ê³„ê°€ ìˆë‹¤.

1. íƒ€ì… ë§¤ì¹­
2. í•„ë“œ ì´ë¦„, íŒŒë¼ë¯¸í„° ì´ë¦„ìœ¼ë¡œ ì¶”ê°€ ë§¤ì¹­

ì´ë ‡ê²Œ í•˜ë©´ ë˜‘ê°™ì€ íƒ€ì…ì„ ê°€ì§€ê³  í•„ë“œëª…ë§Œ ë‹¤ë¥´ê²Œ í•˜ë©´ ìë™ ì£¼ì…í•  ìˆ˜ ìˆë‹¤

ê¸°ì¡´ ì½”ë“œ

```java
	@Autowired
	private DiscountPolicy discountPolicy;
```

ìˆ˜ì •ì½”ë“œ

```java
@Autowired
private DiscountPolicy rateDiscountPolicy;
```

### `@Quilifier` ì‚¬ìš©

`@Quilifier` ëŠ” ì¶”ê°€ êµ¬ë¶„ìë¥¼ ë¶™ì—¬ì£¼ëŠ” ë°©ë²•ì´ë‹¤.

1. `@Quilifier` ë¼ë¦¬ ë§¤ì¹­
2. ëª» ì°¾ìœ¼ë©´ ë¹ˆ ì´ë¦„ ë§¤ì¹­
3. ë˜ ëª» ì°¾ìœ¼ë©´ NoSuchBeanDefinitionException ì—ëŸ¬ ë°œìƒ

```java
@Component
@Qualifier("mainDiscountPolicy")
public class RateDiscountPolicy implements DiscountPolicy

@Autowired
public OrderServiceImpl(MemberRepository memberRepository, @Qualifier("mainDiscountPolicy") DiscountPolicy rateDiscountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = rateDiscountPolicy;
}
```

`@Quilifier` ë¼ë¦¬ ë§¤ì¹­ í•´ì¤„ í•´ì¤„ ë•Œë§Œ ì°¾ëŠ”ê²Œ ì¢‹ë‹¤. ì•„ë‹ˆë©´ í—·ê°ˆë¦¼. ì»´íŒŒì¼ ì‹œì— ê±¸ë¦¬ì§€ë„ ì•Šì•„ì„œ ì—ëŸ¬ ì°¾ê¸° í˜ë“¤ê±° ê°™ë‹¤.

### `@Primary` ì‚¬ìš©

ì´ë¦„ì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ ìš°ì„ ìˆœìœ„ë¥¼ ê²°ì •í•œë‹¤. ì´ê²Œ ë” ì§ê´€ì ì¸ë°??

```java
@Component
@Primary
public class RateDiscountPolicy implements DiscountPolicy
```

## ì–´ë…¸í…Œì´ì…˜ ì§ì ‘ ë§Œë“¤ê¸°

Qualifierì— ìˆëŠ” ì–´ë…¸í…Œì´ì…˜ë“¤ì„ ë³µì‚¬í•˜ê³  mainDiscountPolicy ì´ë¦„ìœ¼ë¡œ ì„¤ì •í•´ë³´ì.

```java
@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER, ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Inherited
@Documented
@Qualifier("mainDiscountPolicy")
public @interface MainDiscountPolicy {
}

@Component
@MainDiscountPolicy <- ì—¬ê¸°ì„œ ì„¤ì • í•´ì£¼ê³ 
public class RateDiscountPolicy implements DiscountPolicy

@Autowired <- ê°€ì ¸ë‹¤ ì“°ëŠ”ë°ì„œë„ ì¨ì£¼ë©´ ëœë‹¤.
public OrderServiceImpl(MemberRepository memberRepository, @MainDiscountPolicy DiscountPolicy rateDiscountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = rateDiscountPolicy;
}

```

## ì¡°íšŒí•œ ë¹ˆì´ ëª¨ë‘ í•„ìš”í•  ë•Œ List, Map

1. `AnnotationConfigApplicationContext` ì— `AutoAppConfig` ì™€ `DiscountService` ë¥¼ ë„£ì–´ì¤€ë‹¤
2. `AutoAppConfig` ì™€ `DiscountService` ì˜ ì»´í¬ë„ŒíŠ¸ í´ë˜ìŠ¤ë“¤ì´ ëª¨ë‘ regist ëœë‹¤.
3. ì´ê±° ì •ë§ í¸í•˜ë‹¤!!

```java
public class AllBeanTest {
    @Test
    void findAllBean() {
	    
		    // AnnotationConfigApplicationContext ì— AutoAppConfigì—ì„œ ìŠ¤ìº”í•œ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë‹¤ ëŒì–´ì˜¨ë‹¤.
		    
        ApplicationContext ac = new AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
        DiscountService discountService = ac.getBean(DiscountService.class);
        Member member = new Member(1L, "userA", Grade.VIP);
        int discountPrice = discountService.discount(member, 10000, "fixDiscountPolicy");

        assertThat(discountService).isInstanceOf(DiscountService.class);
        assertThat(discountPrice).isEqualTo(1000);

        int rateDiscountPrice = discountService.discount(member, 20000, "rateDiscountPolicy");
        assertThat(rateDiscountPrice).isEqualTo(2000);
    }

    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
        private final List<DiscountPolicy> policyList;

        @Autowired
        public DiscountService(Map<String, DiscountPolicy> policyMap, List<DiscountPolicy> policyList) {
            this.policyMap = policyMap;
            this.policyList = policyList;
            System.out.println("policyMap = " + policyMap);
            System.out.println("policyList = " + policyList);
        }

        public int discount(Member member, int price, String discountCode) {
            DiscountPolicy discountPolicy = policyMap.get(discountCode);
            return discountPolicy.discount(member, price);
        }
    }
}
```

## ìë™, ìˆ˜ë™ ë¹ˆë“±ë¡ì˜ ì˜¬ë°”ë¥¸ ì‹¤ë¬´ ìš´ì˜ ê¸°ì¤€

ì™ ë§Œí•˜ë©´ ëŒ€ë¶€ë¶„ ìë™ìœ¼ë¡œ í•œë‹¤. `@Controller` , `@Service` , `@Repository` ì²˜ëŸ¼ ê³„ì¸µì— ë§ì¶°ì„œ ìë™ìœ¼ë¡œ ìŠ¤ìº”ì„ ì§€ì› ë˜ê³ , ë¹ˆ ë“±ë¡ì„ í•´ë„ `@Component` ë§Œ ë„£ì„ ê²ƒì„ êµ³ì´ ì„¤ì •ì„ ìƒˆë¡œ ë§Œë“¤ì–´ì„œ `@Bean` ì ê³  ê°ì²´ ìƒì„±í•˜ëŠ” ê±´ ìƒë‹¹íˆ ë²ˆê±°ë¡­ë‹¤.

### ìˆ˜ë™ ë¹ˆ ë“±ë¡ì„ ì‚¬ìš©í•´ì•¼ í•  ë•Œ

- ê¸°ìˆ  ì§€ì› ê°ì²´ë¥¼ ì‚¬ìš©í•  ë•Œ
  - ì—…ë¬´ ë¡œì§ ë¹ˆ

    ì›¹ì„ ì§€ì›í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, ë ˆí¬ì§€í† ë¦¬ ëŠ” ëª¨ë‘ ì—…ë¬´ ë¡œì§. ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ ì‚¬í•­ì„ ê°œë°œí•  ë•Œ ì¶”ê°€ë˜ê±°ë‚˜ ë³€ê²½ëœë‹¤.

  - ê¸°ìˆ  ì§€ì› ë¹ˆ

    ê¸°ìˆ ì ì¸ ë¬¸ì œë‚˜ ê³µí†µ ê´€ì‹¬ì‚¬(AOP)ë¥¼ ì²˜ë¦¬í•  ë•Œ ì£¼ë¡œ ì‚¬ìš©. DB ì—°ê²°, ë¡œê·¸ ì²˜ë¦¬ì²˜ëŸ¼ ì—…ë¬´ ë¡œì§ì„ ì§€ì›í•˜ê¸° ìœ„í•œ ê³µí†µ ê¸°ìˆ .

  - ì—…ë¬´ ë¡œì§ì€ ìˆ«ìê°€ ë§ê³  íŒ¨í„´ì´ ìœ ì‚¬í•˜ê¸° ë•Œë¬¸ì— ìë™ ê¸°ëŠ¥ ì ê·¹ ì‚¬ìš©. ë¬¸ì œ ì°¾ê¸°ë„ ì‰¬ì›€
  - ê¸°ìˆ  ì§€ì› ë¡œì§ì€ ì—…ë¬´ ë¡œì§ê³¼ ë¹„êµí•´ì„œ ìˆ˜ê°€ ì ê³  ì˜í–¥ì„ ê´‘ë²”ìœ„í•˜ê²Œ ë¼ì¹œë‹¤. ê·¸ë¦¬ê³  ì—…ë¬´ ë¡œì§ì— ë¹„í•´ì„œ ë¬¸ì œ ì°¾ê¸°ë„ ì–´ë ¤ì›€
  - ê¸°ìˆ  ì§€ì› ë¡œì§ì€ ìˆ˜ë™ ë¹ˆ ë“±ë¡ì„ ì‚¬ìš©í•´ì„œ ëª…í™•í•˜ê²Œ ë“¤ì–´ë‚´ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<aside>
ğŸ’¡ ê¸°ìˆ  ì§€ì› ê°ì²´ëŠ” ìˆ˜ë™ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì„œ ì„¤ì • ì •ë³´ì— ë°”ë¡œ ë‚˜íƒ€ë‚˜ê²Œ í•˜ëŠ” ê²ƒì´ ìœ ì§€ë³´ìˆ˜ í•˜ê¸° ì¢‹ë‹¤.

</aside>

- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¤‘ì—ì„œ ë‹¤í˜•ì„±ì„ ì ê·¹ í™œìš© ì¤‘ì¼ ë•Œ
  - ìˆ˜ë™ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê±°ë‚˜ ìë™ì¼ ê²½ìš°ì—ëŠ” íŠ¹ì • íŒ¨í‚¤ì§€ì— ê°™ì´ ë¬¶ì–´ë‘”ë‹¤.

  ì˜ì¡´ê´€ê³„ ìë™ ì£¼ì… - ì¡°íšŒí•œ ë¹ˆì„ ëª¨ë‘ í™•ì¸í•œ List, Mapì˜ ê²½ìš°ë¥¼ ë³´ì.

  `DiscountService` ê°€ ì˜ì¡´ ê´€ê³„ ìë™ ì£¼ì…ìœ¼ë¡œ `Map<String,DiscountPolice>` ì„ ì–¸í•œê±° ë³´ë©´ `DiscountPolicy` ì— ì–´ë–¤ ë¹ˆì´ ì£¼ì…ë ì§€, ê° ë¹ˆë“¤ì˜ ì´ë¦„ì€ ë¬´ì—‡ì¼ì§€ íŒŒì•…í• ë ¤ë©´ ëª‡ ëŒ‘ìŠ¤ë¥¼ ê±°ì³ì„œ íŒŒì•…ì„ í•˜ê³  ë¨¸ë¦¿ì†ì— ì •ë¦¬í•´ì•¼í•œë‹¤. DiscountPolicyë¥¼ êµ¬í˜„í•œ í• ì¸ ì •ì±…ë“¤ì„ ë’¤ì ¸ë´ì•¼í•œë‹¤.

    ```java
    static class DiscountService {
        private final Map<String, DiscountPolicy> policyMap;
    }
        
    ```

  ì´ ë¶€ë¶„ë§Œ ë³„ë„ë¡œ ì„¤ì •ìœ¼ë¡œ ë¹¼ì„œ ìˆ˜ë™ìœ¼ë¡œ í•˜ê±°ë‚˜, ìë™ì¼ ê²½ìš° ê°™ì€ íŒ¨í‚¤ì§€ ì•ˆì— ë„£ëŠ”ë‹¤.

    ```java
    @Configuration
    public class DiscountPolicyConfig {
        @Bean
        public DiscountPolicy rateDiscountPolicy() {
            return new RateDiscountPolicy();
        }
    
        @Bean
        public DiscountPolicy fixDiscountPolicy() {
            return new FixDiscountPolicy();
        }
    }
    ```

  ëˆˆì— ì˜ ë„ëŠ”ê²Œ ì¤‘ìš”í•˜ë‹¤!